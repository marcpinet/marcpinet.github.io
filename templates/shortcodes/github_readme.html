<!-- GitHub README Shortcode -->
<!-- Usage: {{ github_readme(repo="marcpinet/neuralnetlib") }} -->

{% set repo_url = "https://api.github.com/repos/" ~ repo ~ "/readme" %}
{% set raw_url = "https://raw.githubusercontent.com/" ~ repo ~ "/main/README.md" %}

<div class="github-readme" data-repo="{{ repo }}">
    <div class="readme-loading">
        <div class="loading-spinner"></div>
        <p>Loading README from <a href="https://github.com/{{ repo }}" target="_blank">{{ repo }}</a>...</p>
    </div>
    <div class="readme-content" style="display: none;"></div>
    <div class="readme-error" style="display: none;">
        <p>⚠️ Could not load README. <a href="https://github.com/{{ repo }}" target="_blank">View on GitHub</a></p>
    </div>
</div>

<script>
(function() {
    const container = document.querySelector('[data-repo="{{ repo }}"]');
    const loading = container.querySelector('.readme-loading');
    const content = container.querySelector('.readme-content');
    const error = container.querySelector('.readme-error');
    
    // Fetch README content
    fetch('{{ raw_url }}')
        .then(response => {
            if (!response.ok) {
                throw new Error('README not found');
            }
            return response.text();
        })
        .then(markdown => {
            // Simple markdown to HTML conversion
            let html = markdown
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                .replace(/^\> (.*$)/gim, '<blockquote>$1</blockquote>')
                .replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>')
                .replace(/\*(.*)\*/gim, '<em>$1</em>')
                .replace(/!\[([^\]]*)\]\(([^\)]+)\)/gim, '<img alt="$1" src="$2" />')
                .replace(/\[([^\]]*)\]\(([^\)]+)\)/gim, '<a href="$2">$1</a>')
                .replace(/```([^`]+)```/gim, '<pre><code>$1</code></pre>')
                .replace(/`([^`]+)`/gim, '<code>$1</code>')
                .replace(/\n/gim, '<br>');
            
            content.innerHTML = html;
            loading.style.display = 'none';
            content.style.display = 'block';
        })
        .catch(() => {
            loading.style.display = 'none';
            error.style.display = 'block';
        });
})();
</script>

<style>
.github-readme {
    margin: 2rem 0;
    padding: 1rem;
    border: 1px solid var(--border-color, #e1e5e9);
    border-radius: 8px;
    background: var(--background-color, #ffffff);
}

.loading-spinner {
    width: 20px;
    height: 20px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid var(--accent-color, #007acc);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    display: inline-block;
    margin-right: 10px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.readme-content h1, .readme-content h2, .readme-content h3 {
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
}

.readme-content pre {
    background: var(--code-background, #f6f8fa);
    padding: 1rem;
    border-radius: 4px;
    overflow-x: auto;
}

.readme-content code {
    background: var(--code-background, #f6f8fa);
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
}
</style>